<!DOCTYPE html>
<html>
  <head>
    <title>Chat Bot</title>
     <style>
      .send-button{
        height: 40px;
        background-color: green;
        font-size: 20px;
        color : white;
        padding: 0px 20px;
        margin-left: 10px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        flex-grow: 0.025;
      }
      .input-box{
        height: 40px;
        padding: 0px 20px;
        margin-bottom: 20px;
        border-radius: 10px;
        border: 2px solid rgb(255, 200, 200);;
        font-size: 30px;
        flex-grow: 1;
        
  
      }
      .chat-input-container {
        display: flex;
      }
      .input-box:focus::placeholder {
        color: transparent;   /* or opacity: 0; */
      }
    
      .app-container {
        max-width: 600px;
        margin-left: auto; 
        margin-right: auto;
        
      }
      .input-box::placeholder {
        color: gray;
        font-size: 20px;
        opacity: 1;
      }
     
      .chat-message-user{
        display: flex;
        justify-content: end;
      }
      .chat-message-robot{
        display: flex;
      }
      .chat-message-text{
     
        margin: 10px;
        background-color: antiquewhite;
        padding: 10px 20px;
        border-radius: 20px;
      }

   
      
    </style> 
  </head>
  <body>
    <div class="js-container"></div>

    <script src="https://unpkg.com/supersimpledev/react.js"></script>
    <script src="https://unpkg.com/supersimpledev/react-dom.js"></script>
    <script src="https://unpkg.com/supersimpledev/chatbot.js"></script>
    <script src="https://unpkg.com/supersimpledev/babel.js"></script>
    <script type="text/babel">
 





      function ChatInput ({setChatMessages}) {
        const [inputText, setInputText] = React.useState('');
        
         function SendMessage (){
          setChatMessages(prevChat => [...prevChat,{message: inputText, sender: 'user', id: crypto.randomUUID() }]);
          
          const response = chatbot.getResponse(inputText);
          setChatMessages(prevChat => [...prevChat,{message: response, sender: 'robot', id: crypto.randomUUID() }]);

          setInputText(''); // clear box 
        } 
        return(
        <div className = "chat-input-container"> 
          <input 
          className = "input-box"
          placeholder = " Type to ask" 
          size = "30"
          onChange = {event => setInputText(event.target.value)}
          value = {inputText}
          onKeyDown={e => e.key === "Enter" && SendMessage()}
          /> 
          <button className = "send-button" onClick={SendMessage}> send </button>
        </div>    
        )
      }
      function ChatMessage ({message, sender}) {
        return(
          <div className = {sender === 'user' ? 'chat-message-user' : 'chat-message-robot'}
            style = {{fontSize : "30px"}}>
            
            {sender === "robot" && 
            <img 
            src="./image/robot.png" 
            width = "40"
            className = 'robot-image' 
            alt="robot" 
            />
            }

          
            <div className  = 'chat-message-text'>{message}</div>
            

            
            {sender === "user" && 
              <img 
              src="./image/human.png" 
              width = "40" 
              alt="user"     
              />
              }
            
          </div>
        )     
      }
      function ChatMessages({chatMessages}){
        return(
        <>

          {chatMessages.map((chatMessageEle) => 
            <ChatMessage
              message = {chatMessageEle.message}
              sender = {chatMessageEle.sender}
              key = {chatMessageEle.id}
            />
          )}
        </>
      )
      }

      function App () 
      {
         const [chatMessages, setChatMessages] = React.useState([{
          message: 'hello chatbot',
          sender : 'user',
          id: "id1"    
        },
        {
          message : "hello how can i help you today?", 
          sender : "robot",
          id: "id2"
        }, {
          message : "what date is today?",
          sender : "user",
          id: "id3"
        }, {
          message : "today is 9/11",
          sender : "robot",
          id: "id4"
        }])

        return( 
        <div className = "app-container"> 
          <ChatInput
            chatMessages = {chatMessages}
            setChatMessages = {setChatMessages}
          />
          <ChatMessages
            chatMessages = {chatMessages}/>
        </div>
        )
      }

      const container = document.querySelector('.js-container');
      ReactDOM.createRoot(container).render(<App/>);
    </script>
  </body>
</html>